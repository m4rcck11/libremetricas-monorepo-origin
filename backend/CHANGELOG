CHANGELOG
=========

2024-11-07 - Correções de Compatibilidade API Frontend
------------------------------------------------------

Alteracoes em backend/app/queries.py:

- Adicionada funcao all_sources_list() que retorna lista simples de sources
- Modificada funcao all_sources() para usar alias AS source no campo source_
- Modificada funcao all_sources_filter_years() para usar alias AS source no campo source_
- Adicionada funcao fields_events_filtered() para filtrar eventos por area de pesquisa dentro de intervalo de anos

Alteracoes em backend/app/main.py:

- Modificado endpoint /sources para retornar formato {sources: [...]} ao inves de formato colunar
- Adicionados imports Query e Optional do FastAPI
- Modificado endpoint /events_sources para aceitar query parameters ya e yb para filtro de ano
- Modificado endpoint /fields_events para aceitar query parameters ya e yb para filtro de ano
- Implementada logica condicional nos endpoints para aplicar filtros quando parametros sao fornecidos

Resultados:

- Endpoint /sources agora retorna lista simples conforme esperado pelo frontend
- Todas as respostas que retornam source agora usam campo source ao inves de source_
- Filtros de ano funcionam via query parameters ?ya=2020&yb=2023
- Dashboard pode carregar e exibir dados corretamente

2024-11-07 - Integracao Search DOI no Frontend
------------------------------------------------

Alteracoes em frontend/src/api/services.js:

- Adicionada funcao searchDois() para chamar endpoint POST /search_dois do backend
- Implementado tratamento de erros com console.error e throw

Alteracoes em frontend/src/pages/DoiSearch.jsx:

- Adicionados imports: CircularProgress, Alert, Chip do Material-UI e searchDois de services
- Adicionados estados: loading, error e searchResults (alterado de array para objeto)
- Modificada funcao handleSearch() para fazer chamada assincrona à API
- Implementado loading spinner no botao de busca durante execucao
- Adicionada exibicao de erros com componente Alert
- Implementada exibicao estruturada dos resultados com:
  - Estatisticas agregadas (total buscado, encontrados, nao encontrados)
  - Detalhes por DOI com chips de status (encontrado/nao encontrado)
  - Agregacao de eventos por fonte com chips
  - Agregacao de eventos por ano com chips ordenados
  - Layout organizado com Box e Paper do Material-UI

Resultados:

- Busca de DOIs agora funciona com integracao real ao backend
- Usuario recebe feedback visual durante busca (loading spinner)
- Erros sao exibidos de forma clara e amigavel
- Resultados mostram metricas altmetricas agregadas por fonte e ano
- Interface permite visualizar facilmente quais DOIs foram encontrados e suas estatisticas

